local Players = game:GetService("Players")
local LP = Players.LocalPlayer
local CG = game:GetService("CoreGui")

-- 1. Xóa Menu cũ (Dùng tên cũ để tránh kẹt)
if CG:FindFirstChild("DatDepTraiMenu") then CG.DatDepTraiMenu:Destroy() end

local G = Instance.new("ScreenGui", CG); G.Name = "DatDepTraiMenu"; G.ResetOnSpawn = false

-- 2. NÚT MỞ/ĐÓNG NHỎ GỌN
local Tgl = Instance.new("TextButton", G)
Tgl.Size = UDim2.new(0, 80, 0, 30); Tgl.Position = UDim2.new(0, 15, 0.5, 0)
Tgl.BackgroundColor3 = Color3.fromRGB(20, 20, 20); Tgl.Text = "OPEN"; Tgl.TextColor3 = Color3.new(1, 1, 1)
Tgl.Font = "SourceSansBold"; Tgl.TextSize = 14; Instance.new("UICorner", Tgl)

-- 3. KHUNG MENU RGB
local F = Instance.new("Frame", G)
F.Size = UDim2.new(0, 220, 0, 300); F.Position = UDim2.new(0.5, -110, 0.3, 0)
F.BackgroundColor3 = Color3.fromRGB(10, 10, 10); F.BorderSizePixel = 3; F.Visible = false
F.Active = true; F.Draggable = true; Instance.new("UICorner", F)

-- Hiệu ứng viền 7 màu (RGB)
spawn(function()
    while task.wait() do F.BorderColor3 = Color3.fromHSV(tick() % 5 / 5, 1, 1) end
end)

-- ĐỔI TÊN TIÊU ĐỀ Ở ĐÂY
local Title = Instance.new("TextLabel", F)
Title.Text = "DATDEPTRAI MENU"; Title.Size = UDim2.new(1, 0, 0, 40); Title.BackgroundTransparency = 1
Title.TextColor3 = Color3.new(1, 1, 0); Title.Font = "SourceSansBold"; Title.TextSize = 18

local Scroll = Instance.new("ScrollingFrame", F)
Scroll.Size = UDim2.new(1, -20, 1, -60); Scroll.Position = UDim2.new(0, 10, 0, 50)
Scroll.BackgroundTransparency = 1; Scroll.CanvasSize = UDim2.new(0, 0, 0, 0); Scroll.ScrollBarThickness = 3
local Layout = Instance.new("UIListLayout", Scroll); Layout.Padding = UDim.new(0, 5)

-- 4. HÀM CẬP NHẬT & TELE ĐỨNG GẦN
local function Refresh()
    for _, v in pairs(Scroll:GetChildren()) do if v:IsA("TextButton") then v:Destroy() end end
    for _, p in pairs(Players:GetPlayers()) do
        if p ~= LP then
            local b = Instance.new("TextButton", Scroll)
            b.Text = p.DisplayName; b.Size = UDim2.new(1, -5, 0, 35)
            b.BackgroundColor3 = Color3.fromRGB(45, 45, 45); b.TextColor3 = Color3.new(1, 1, 1)
            b.Font = "SourceSans"; b.TextSize = 16; Instance.new("UICorner", b)
            b.MouseButton1Click:Connect(function()
                pcall(function()
                    if p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                        LP.Character.HumanoidRootPart.CFrame = p.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 3)
                    end
                end)
            end)
        end
    end
    Scroll.CanvasSize = UDim2.new(0, 0, 0, Layout.AbsoluteContentSize.Y)
end

Players.PlayerAdded:Connect(Refresh); Players.PlayerRemoving:Connect(Refresh)
Refresh()

Tgl.MouseButton1Click:Connect(function()
    F.Visible = not F.Visible
    Tgl.Text = F.Visible and "CLOSE" or "OPEN"
end)
